\hypertarget{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h}{}\doxysection{ctrl/\+STM32\+Cube\+IDE/\+STM32\+F401/\+Inc/\+FB19\+Lib\+MsgQ.h File Reference}
\label{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h}\index{ctrl/STM32CubeIDE/STM32F401/Inc/FB19LibMsgQ.h@{ctrl/STM32CubeIDE/STM32F401/Inc/FB19LibMsgQ.h}}


This file publishes the interface of a Field\+Bus19 library that encapsulates a specific type of message queue.  


{\ttfamily \#include \char`\"{}FB19\+Def.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}FB19\+Msg.\+h\char`\"{}}\newline
Include dependency graph for FB19\+Lib\+Msg\+Q.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct_f_b19_lib_msg_q__element__struct}{FB19\+Lib\+Msg\+Q\+\_\+element\+\_\+struct}}
\item 
struct \mbox{\hyperlink{struct_f_b19_lib_msg_q__queue__struct}{FB19\+Lib\+Msg\+Q\+\_\+queue\+\_\+struct}}
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{struct_f_b19_lib_msg_q__element__struct}{FB19\+Lib\+Msg\+Q\+\_\+element\+\_\+struct}} \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a436d6f082a491ea2d9e524fcd9b3de9b}{FB19\+Lib\+Msg\+Q\+\_\+element\+\_\+t}}
\item 
typedef struct \mbox{\hyperlink{struct_f_b19_lib_msg_q__queue__struct}{FB19\+Lib\+Msg\+Q\+\_\+queue\+\_\+struct}} \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a824025c23dc2eece4fbb126b33a6ef08}{FB19\+Lib\+Msg\+Q\+\_\+queue\+\_\+t}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a994ccbaa951324a8174fea965d747b6c}{FB19\+Lib\+Msg\+Q\+\_\+init}} (\mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a824025c23dc2eece4fbb126b33a6ef08}{FB19\+Lib\+Msg\+Q\+\_\+queue\+\_\+t}} queue)
\item 
int \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a61f86a483d5aea2a7a2bec2b64383193}{FB19\+Lib\+Msg\+Q\+\_\+read}} (\mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a824025c23dc2eece4fbb126b33a6ef08}{FB19\+Lib\+Msg\+Q\+\_\+queue\+\_\+t}} queue, \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_msg_8h_afa89bd818747be891ceba5148c1b5304}{FB19\+Msg\+\_\+t}} $\ast$msg)
\item 
int \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a7d48bfb12b478a2616cecf362058766a}{FB19\+Lib\+Msg\+Q\+\_\+write}} (\mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a824025c23dc2eece4fbb126b33a6ef08}{FB19\+Lib\+Msg\+Q\+\_\+queue\+\_\+t}} queue, const \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_msg_8h_afa89bd818747be891ceba5148c1b5304}{FB19\+Msg\+\_\+t}} $\ast$msg)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This file publishes the interface of a Field\+Bus19 library that encapsulates a specific type of message queue. 


\begin{DoxyItemize}
\item Filename\+: FB19\+Lib\+Msg\+Q.\+h
\item Platform(s)\+: All
\item Project\+: Field\+Bus19
\item Created\+: May 19, 2022
\item Description\+: This file publishes the interface of a Field\+Bus19 library that encapsulates a specific type of message queue.

It is used by\+:
\begin{DoxyItemize}
\item Bus Controllers as \textquotesingle{}low frequency readers queue\textquotesingle{} in the FB19\+Dpr\+Ctrl module
\item Bus Subscribers as transmit queue in the FB19\+Drv\+Subs module It is basically a ring buffer that on write overwrites the oldest element when full and returns an error on read when empty.~\newline
 During a read call, the {\ttfamily msg} parameter is both an input and output parameter. It is initially an input parameter since the $<$dst\+Id$>$ and $<$msg\+Id$>$ fields in the object pointed to by {\ttfamily msg$\ast$} specify what message type shall be returned. A read returns an error if it specifies a message whose $<$dst\+Id$>$ AND $<$msg\+Id$>$ aren\textquotesingle{}t found in the queue.~\newline
 Additionally, when the queue stores multiple messages with identical $<$dst\+Id$>$ and $<$msg\+Id$>$ fields, the oldest of those messages is returned on a read (and not simply the oldest message in the queue).~\newline

\end{DoxyItemize}
\item Notes\+: This module has been designed for multi-\/instance usage.~\newline
 That scenario comes into play when a Controller and one or more Subscribers are implemented in one single application. Examples are test applications or connected FB19 bus systems that exchange messages via a Bus Controller / Bus Subscriber application.~\newline
 For achieving multi-\/instance usage this module doesn\textquotesingle{}t contain the message queue. It has to be passed at every function call instead. That way, the module is stateless and can be used by several clients simultaneously.
\item Author\+: Andreas Isenegger
\item Copyright\+: 2022-\/2023, Bitcontrol GmbH, Switzerland. All rights reserved. 
\end{DoxyItemize}

\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a436d6f082a491ea2d9e524fcd9b3de9b}\label{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a436d6f082a491ea2d9e524fcd9b3de9b}} 
\index{FB19LibMsgQ.h@{FB19LibMsgQ.h}!FB19LibMsgQ\_element\_t@{FB19LibMsgQ\_element\_t}}
\index{FB19LibMsgQ\_element\_t@{FB19LibMsgQ\_element\_t}!FB19LibMsgQ.h@{FB19LibMsgQ.h}}
\doxysubsubsection{\texorpdfstring{FB19LibMsgQ\_element\_t}{FB19LibMsgQ\_element\_t}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{struct_f_b19_lib_msg_q__element__struct}{FB19\+Lib\+Msg\+Q\+\_\+element\+\_\+struct}} \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a436d6f082a491ea2d9e524fcd9b3de9b}{FB19\+Lib\+Msg\+Q\+\_\+element\+\_\+t}}}

The message queue stores this type of data. \mbox{\Hypertarget{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a824025c23dc2eece4fbb126b33a6ef08}\label{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a824025c23dc2eece4fbb126b33a6ef08}} 
\index{FB19LibMsgQ.h@{FB19LibMsgQ.h}!FB19LibMsgQ\_queue\_t@{FB19LibMsgQ\_queue\_t}}
\index{FB19LibMsgQ\_queue\_t@{FB19LibMsgQ\_queue\_t}!FB19LibMsgQ.h@{FB19LibMsgQ.h}}
\doxysubsubsection{\texorpdfstring{FB19LibMsgQ\_queue\_t}{FB19LibMsgQ\_queue\_t}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{struct_f_b19_lib_msg_q__queue__struct}{FB19\+Lib\+Msg\+Q\+\_\+queue\+\_\+struct}} \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a824025c23dc2eece4fbb126b33a6ef08}{FB19\+Lib\+Msg\+Q\+\_\+queue\+\_\+t}}}

This data type defines a message queue. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a994ccbaa951324a8174fea965d747b6c}\label{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a994ccbaa951324a8174fea965d747b6c}} 
\index{FB19LibMsgQ.h@{FB19LibMsgQ.h}!FB19LibMsgQ\_init@{FB19LibMsgQ\_init}}
\index{FB19LibMsgQ\_init@{FB19LibMsgQ\_init}!FB19LibMsgQ.h@{FB19LibMsgQ.h}}
\doxysubsubsection{\texorpdfstring{FB19LibMsgQ\_init()}{FB19LibMsgQ\_init()}}
{\footnotesize\ttfamily int FB19\+Lib\+Msg\+Q\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a824025c23dc2eece4fbb126b33a6ef08}{FB19\+Lib\+Msg\+Q\+\_\+queue\+\_\+t}}}]{queue }\end{DoxyParamCaption})}

Initializes the elements of the passed queue.

Call it at least once before using a queue object. It clears the memory of the internal elements to {\ttfamily 0}.~\newline
 Don\textquotesingle{}t modify the passed {\ttfamily queue} object outside the {\ttfamily \+\_\+read()} or {\ttfamily \+\_\+write()} functions of this module!


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em queue} & is the message queue that shall be initialized. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily R\+\_\+\+SUCCESS} if the message queue could be initialized, {\ttfamily R\+\_\+\+ERROR} otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a61f86a483d5aea2a7a2bec2b64383193}\label{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a61f86a483d5aea2a7a2bec2b64383193}} 
\index{FB19LibMsgQ.h@{FB19LibMsgQ.h}!FB19LibMsgQ\_read@{FB19LibMsgQ\_read}}
\index{FB19LibMsgQ\_read@{FB19LibMsgQ\_read}!FB19LibMsgQ.h@{FB19LibMsgQ.h}}
\doxysubsubsection{\texorpdfstring{FB19LibMsgQ\_read()}{FB19LibMsgQ\_read()}}
{\footnotesize\ttfamily int FB19\+Lib\+Msg\+Q\+\_\+read (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a824025c23dc2eece4fbb126b33a6ef08}{FB19\+Lib\+Msg\+Q\+\_\+queue\+\_\+t}}}]{queue,  }\item[{\mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_msg_8h_afa89bd818747be891ceba5148c1b5304}{FB19\+Msg\+\_\+t}} $\ast$}]{msg }\end{DoxyParamCaption})}

Copies the oldest unread message that matches the destination address and message identifier of the message pointed to by the {\ttfamily msg} parameter from the queue into the passed message, thereby removing the message from the queue.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em queue} & is the message queue that shall be read from. \\
\hline
 & {\em \mbox{[}in/out\mbox{]}} & msg points to the message that will hold the result when this function has returned successfully. If no matching message could be found the message {\ttfamily msg} points to won\textquotesingle{}t be changed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily R\+\_\+\+SUCCESS} if the parameter checks pass and an unread message that matches the identifiers in {\ttfamily msg-\/\texorpdfstring{$>$}{>}dscr} could be found, {\ttfamily R\+\_\+\+ERROR} otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a7d48bfb12b478a2616cecf362058766a}\label{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a7d48bfb12b478a2616cecf362058766a}} 
\index{FB19LibMsgQ.h@{FB19LibMsgQ.h}!FB19LibMsgQ\_write@{FB19LibMsgQ\_write}}
\index{FB19LibMsgQ\_write@{FB19LibMsgQ\_write}!FB19LibMsgQ.h@{FB19LibMsgQ.h}}
\doxysubsubsection{\texorpdfstring{FB19LibMsgQ\_write()}{FB19LibMsgQ\_write()}}
{\footnotesize\ttfamily int FB19\+Lib\+Msg\+Q\+\_\+write (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_lib_msg_q_8h_a824025c23dc2eece4fbb126b33a6ef08}{FB19\+Lib\+Msg\+Q\+\_\+queue\+\_\+t}}}]{queue,  }\item[{const \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_msg_8h_afa89bd818747be891ceba5148c1b5304}{FB19\+Msg\+\_\+t}} $\ast$}]{msg }\end{DoxyParamCaption})}

Copies the message pointed to by the {\ttfamily msg} parameter to the queue. If the queue is already full, the oldest message is overwritten.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em queue} & is the message queue that shall be written to. \\
\hline
\mbox{\texttt{ in}}  & {\em msg} & points to the message to be queued. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily R\+\_\+\+SUCCESS} if the parameter checks pass, {\ttfamily R\+\_\+\+ERROR} otherwise. 
\end{DoxyReturn}
