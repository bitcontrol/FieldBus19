\hypertarget{_f_b19_subs_8h}{}\doxysection{subs/\+STM32\+Cube\+IDE/\+STM32\+F401/\+Inc/\+FB19\+Subs.h File Reference}
\label{_f_b19_subs_8h}\index{subs/STM32CubeIDE/STM32F401/Inc/FB19Subs.h@{subs/STM32CubeIDE/STM32F401/Inc/FB19Subs.h}}


This file publishes the interface of the Field\+Bus19 Subscriber library.  


{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$stm32f4xx.\+h$>$}\newline
{\ttfamily \#include \char`\"{}FB19\+Def.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}FB19\+Lib\+Msg\+Q.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}FB19\+Msg.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}FB19\+Msg\+Q.\+h\char`\"{}}\newline
Include dependency graph for FB19\+Subs.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct_f_b19_subs__cfg__struct}{FB19\+Subs\+\_\+cfg\+\_\+struct}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{_f_b19_subs_8h_ae3cc13869bc14c96f70220108f067829}{FB19\+\_\+\+SUBS\+\_\+\+BIT\+\_\+\+RATE\+\_\+\+MAX}}~250000
\item 
\#define \mbox{\hyperlink{_f_b19_subs_8h_a154210a6c08ccb8b099e169f5a0ad638}{FB19\+\_\+\+SUBS\+\_\+\+BIT\+\_\+\+RATE\+\_\+\+MIN}}~2000
\item 
\#define \mbox{\hyperlink{_f_b19_subs_8h_af0ac90c828398ab1295732d493d045a2}{FB19\+\_\+\+SUBS\+\_\+\+BUS\+\_\+\+ADDR\+\_\+\+HIGHEST}}~4
\item 
\#define \mbox{\hyperlink{_f_b19_subs_8h_aa1d334cb4ba1439c6306d8163e4f75e2}{FB19\+\_\+\+SUBS\+\_\+\+BUS\+\_\+\+ADDR\+\_\+\+LOWEST}}~1
\item 
\#define \mbox{\hyperlink{_f_b19_subs_8h_ac0dde5eecd1e38f0869165acdac9a92f}{FB19\+\_\+\+SUBS\+\_\+\+MEM\+\_\+\+SIZE}}~268
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{struct_f_b19_subs__cfg__struct}{FB19\+Subs\+\_\+cfg\+\_\+struct}} \mbox{\hyperlink{_f_b19_subs_8h_ab3c37fbacd25aba8f93e03f94ddcaa82}{FB19\+Subs\+\_\+cfg\+\_\+t}}
\item 
typedef uint8\+\_\+t \mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}}\mbox{[}\mbox{\hyperlink{_f_b19_subs_8h_ac0dde5eecd1e38f0869165acdac9a92f}{FB19\+\_\+\+SUBS\+\_\+\+MEM\+\_\+\+SIZE}}\mbox{]}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{_f_b19_subs_8h_abaa3b5c370fc792104e2c14e23e4b7d3}{FB19\+Subs\+\_\+start}} (\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$instance, const \mbox{\hyperlink{_f_b19_subs_8h_ab3c37fbacd25aba8f93e03f94ddcaa82}{FB19\+Subs\+\_\+cfg\+\_\+t}} $\ast$config, int bit\+Rate)
\item 
int \mbox{\hyperlink{_f_b19_subs_8h_a4b17eda87916e2e22a60004aaa377e9d}{FB19\+Subs\+\_\+stop}} (\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$instance)
\item 
void \mbox{\hyperlink{_f_b19_subs_8h_a0dee31fc9ba75a44493cd6e8ae7c6e75}{FB19\+Subs\+\_\+handler}} (\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$instance)
\item 
int \mbox{\hyperlink{_f_b19_subs_8h_af0e8477fe9617ba507fc0278eebad126}{FB19\+Subs\+\_\+fetch}} (\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$instance, \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_msg_8h_afa89bd818747be891ceba5148c1b5304}{FB19\+Msg\+\_\+t}} $\ast$msg)
\item 
int \mbox{\hyperlink{_f_b19_subs_8h_afd6b6f1b2853c998ffab7636c1182f1e}{FB19\+Subs\+\_\+get\+Bus\+Address}} (\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$instance, int16\+\_\+t $\ast$addr)
\item 
int \mbox{\hyperlink{_f_b19_subs_8h_ae25bd97c7408f773a168033f016399ba}{FB19\+Subs\+\_\+get\+Noise\+Fault\+Count}} (\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$instance, uint32\+\_\+t $\ast$count)
\item 
int \mbox{\hyperlink{_f_b19_subs_8h_a566d446f8e91d34a08aae7d356909a59}{FB19\+Subs\+\_\+get\+Rx\+Fault\+Count}} (\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$instance, uint32\+\_\+t $\ast$count)
\item 
int \mbox{\hyperlink{_f_b19_subs_8h_a4f4a523efa22c9dbdff49a67b181a478}{FB19\+Subs\+\_\+get\+Tx\+Fault\+Count}} (\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$instance, uint32\+\_\+t $\ast$count)
\item 
const char $\ast$ \mbox{\hyperlink{_f_b19_subs_8h_a089309456f180d557fb62bfe9f68db81}{FB19\+Subs\+\_\+get\+Version}} ()
\item 
int \mbox{\hyperlink{_f_b19_subs_8h_aba9f9bdf9b3651a6d4d2233670eda546}{FB19\+Subs\+\_\+submit}} (\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$instance, const \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_msg_8h_afa89bd818747be891ceba5148c1b5304}{FB19\+Msg\+\_\+t}} $\ast$msg)
\item 
void \mbox{\hyperlink{_f_b19_subs_8h_a5095e2d29f0408048592057b553e7932}{FB19\+Subs\+\_\+timer\+IRQHandler}} (\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$instance)
\item 
void \mbox{\hyperlink{_f_b19_subs_8h_ac39b2fe42c5319bab1efe8e0478cc77d}{FB19\+Subs\+\_\+\+Uart\+IRQHandler}} (\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$instance)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This file publishes the interface of the Field\+Bus19 Subscriber library. 


\begin{DoxyItemize}
\item Filename\+: \mbox{\hyperlink{_f_b19_subs_8h}{FB19\+Subs.\+h}}
\item Platform(s)\+: All
\item Project\+: FB19\+Subs\+Lib
\item Created\+: May 23, 2023
\item Description\+: This file publishes the interface of the Field\+Bus19 Subscriber library.

A note on the parameter {\ttfamily instance\+:} The parameter {\ttfamily instance} can be thought of as a \textquotesingle{}handle\textquotesingle{} to the Subscriber instance. It is the start address of the memory area, where the instance stores its internal values (buffers, counters, pointers, ...).

It doesn\textquotesingle{}t matter for this library if the memory has been allocated statically, dynamically or on the stack. Just make sure it\textquotesingle{}s not deallocated before the FB19 Subscriber is stopped by a call to \mbox{\hyperlink{_f_b19_subs_8h_a4b17eda87916e2e22a60004aaa377e9d}{FB19\+Subs\+\_\+stop()}}, or the behavior of the Subscriber will be undefined.~\newline
 That way, this library doesn\textquotesingle{}t have to allocate memory internally; all required memory space is passed from the outside.

Limitation of the bit rate\+:~\newline
 This version of the FB19 Subscriber library is limited to a maximum bit rate of 250kbit/s, although many of STM\textquotesingle{}s microcontroller families could run the bus at considerably higher rates.

Limitation of the number of Subscribers\+:~\newline
 This version of the FB19 Subscriber library is limited to a maximum number of 8 Subscribers, although it could by design handle up to 30 Subscribers.

Code size and stack requirements\+:~\newline
 This library was designed with the economic use of resources in mind. It occupies little FLASH memory and uses the stack economically. Please consult the output of your linker and debugger for detailed and accurate information.
\item Notes\+: DON\textquotesingle{}T CHANGE EXISTING CODE!
\item Author\+: Andreas Isenegger
\item Copyright\+: 2023, Bitcontrol GmbH, Switzerland. All rights reserved. 
\end{DoxyItemize}

\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{_f_b19_subs_8h_ae3cc13869bc14c96f70220108f067829}\label{_f_b19_subs_8h_ae3cc13869bc14c96f70220108f067829}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19\_SUBS\_BIT\_RATE\_MAX@{FB19\_SUBS\_BIT\_RATE\_MAX}}
\index{FB19\_SUBS\_BIT\_RATE\_MAX@{FB19\_SUBS\_BIT\_RATE\_MAX}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19\_SUBS\_BIT\_RATE\_MAX}{FB19\_SUBS\_BIT\_RATE\_MAX}}
{\footnotesize\ttfamily \#define FB19\+\_\+\+SUBS\+\_\+\+BIT\+\_\+\+RATE\+\_\+\+MAX~250000}

Maximum bit rate in bit/s. \mbox{\Hypertarget{_f_b19_subs_8h_a154210a6c08ccb8b099e169f5a0ad638}\label{_f_b19_subs_8h_a154210a6c08ccb8b099e169f5a0ad638}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19\_SUBS\_BIT\_RATE\_MIN@{FB19\_SUBS\_BIT\_RATE\_MIN}}
\index{FB19\_SUBS\_BIT\_RATE\_MIN@{FB19\_SUBS\_BIT\_RATE\_MIN}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19\_SUBS\_BIT\_RATE\_MIN}{FB19\_SUBS\_BIT\_RATE\_MIN}}
{\footnotesize\ttfamily \#define FB19\+\_\+\+SUBS\+\_\+\+BIT\+\_\+\+RATE\+\_\+\+MIN~2000}

Minimum bit rate in bit/s. \mbox{\Hypertarget{_f_b19_subs_8h_af0ac90c828398ab1295732d493d045a2}\label{_f_b19_subs_8h_af0ac90c828398ab1295732d493d045a2}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19\_SUBS\_BUS\_ADDR\_HIGHEST@{FB19\_SUBS\_BUS\_ADDR\_HIGHEST}}
\index{FB19\_SUBS\_BUS\_ADDR\_HIGHEST@{FB19\_SUBS\_BUS\_ADDR\_HIGHEST}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19\_SUBS\_BUS\_ADDR\_HIGHEST}{FB19\_SUBS\_BUS\_ADDR\_HIGHEST}}
{\footnotesize\ttfamily \#define FB19\+\_\+\+SUBS\+\_\+\+BUS\+\_\+\+ADDR\+\_\+\+HIGHEST~4}

Highest Bus Subscriber address. \mbox{\Hypertarget{_f_b19_subs_8h_aa1d334cb4ba1439c6306d8163e4f75e2}\label{_f_b19_subs_8h_aa1d334cb4ba1439c6306d8163e4f75e2}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19\_SUBS\_BUS\_ADDR\_LOWEST@{FB19\_SUBS\_BUS\_ADDR\_LOWEST}}
\index{FB19\_SUBS\_BUS\_ADDR\_LOWEST@{FB19\_SUBS\_BUS\_ADDR\_LOWEST}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19\_SUBS\_BUS\_ADDR\_LOWEST}{FB19\_SUBS\_BUS\_ADDR\_LOWEST}}
{\footnotesize\ttfamily \#define FB19\+\_\+\+SUBS\+\_\+\+BUS\+\_\+\+ADDR\+\_\+\+LOWEST~1}

Lowest Bus Subscriber address. \mbox{\Hypertarget{_f_b19_subs_8h_ac0dde5eecd1e38f0869165acdac9a92f}\label{_f_b19_subs_8h_ac0dde5eecd1e38f0869165acdac9a92f}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19\_SUBS\_MEM\_SIZE@{FB19\_SUBS\_MEM\_SIZE}}
\index{FB19\_SUBS\_MEM\_SIZE@{FB19\_SUBS\_MEM\_SIZE}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19\_SUBS\_MEM\_SIZE}{FB19\_SUBS\_MEM\_SIZE}}
{\footnotesize\ttfamily \#define FB19\+\_\+\+SUBS\+\_\+\+MEM\+\_\+\+SIZE~268}

The size of the memory in bytes required to run an FB19 Subscriber instance.

Note that this number doesn\textquotesingle{}t include the sizes of the five message queues that have to be allocated outside this library. They are passed via pointers in the {\ttfamily FB19\+Subs\+\_\+cfg\+\_\+t} configuration type. 

\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{_f_b19_subs_8h_ab3c37fbacd25aba8f93e03f94ddcaa82}\label{_f_b19_subs_8h_ab3c37fbacd25aba8f93e03f94ddcaa82}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_cfg\_t@{FB19Subs\_cfg\_t}}
\index{FB19Subs\_cfg\_t@{FB19Subs\_cfg\_t}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_cfg\_t}{FB19Subs\_cfg\_t}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{struct_f_b19_subs__cfg__struct}{FB19\+Subs\+\_\+cfg\+\_\+struct}} \mbox{\hyperlink{_f_b19_subs_8h_ab3c37fbacd25aba8f93e03f94ddcaa82}{FB19\+Subs\+\_\+cfg\+\_\+t}}}

FB19 Subscriber configuration structure. \mbox{\Hypertarget{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}\label{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_inst\_t@{FB19Subs\_inst\_t}}
\index{FB19Subs\_inst\_t@{FB19Subs\_inst\_t}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_inst\_t}{FB19Subs\_inst\_t}}
{\footnotesize\ttfamily typedef uint8\+\_\+t FB19\+Subs\+\_\+inst\+\_\+t\mbox{[}\mbox{\hyperlink{_f_b19_subs_8h_ac0dde5eecd1e38f0869165acdac9a92f}{FB19\+\_\+\+SUBS\+\_\+\+MEM\+\_\+\+SIZE}}\mbox{]}}

FB19 Subscriber memory and instance type. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{_f_b19_subs_8h_af0e8477fe9617ba507fc0278eebad126}\label{_f_b19_subs_8h_af0e8477fe9617ba507fc0278eebad126}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_fetch@{FB19Subs\_fetch}}
\index{FB19Subs\_fetch@{FB19Subs\_fetch}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_fetch()}{FB19Subs\_fetch()}}
{\footnotesize\ttfamily int FB19\+Subs\+\_\+fetch (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$}]{instance,  }\item[{\mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_msg_8h_afa89bd818747be891ceba5148c1b5304}{FB19\+Msg\+\_\+t}} $\ast$}]{msg }\end{DoxyParamCaption})}

Deep copies the oldest unread message that matches the passed message identifier {\ttfamily msg\+Id} into the message the {\ttfamily msg} parameter points to.

In the receive message queue, the message is thereby marked as consumed. It cannot be read a second time.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em instance} & points to the memory resource used by this instance. \\
\hline
\mbox{\texttt{ out}}  & {\em msg} & points to the object that will hold the fetched message after this function has returned successfully. In case of an error, it won\textquotesingle{}t be changed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily R\+\_\+\+SUCCESS} if the parameter checks pass and an unread message that matches the message identifier in the descriptor of the message the {\ttfamily msg} parameter points to could be found, {\ttfamily R\+\_\+\+ERROR} otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{_f_b19_subs_8h_afd6b6f1b2853c998ffab7636c1182f1e}\label{_f_b19_subs_8h_afd6b6f1b2853c998ffab7636c1182f1e}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_getBusAddress@{FB19Subs\_getBusAddress}}
\index{FB19Subs\_getBusAddress@{FB19Subs\_getBusAddress}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_getBusAddress()}{FB19Subs\_getBusAddress()}}
{\footnotesize\ttfamily int FB19\+Subs\+\_\+get\+Bus\+Address (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$}]{instance,  }\item[{int16\+\_\+t $\ast$}]{addr }\end{DoxyParamCaption})}

Copies the bus address of this subscriber instance to the variable {\ttfamily addr} points to.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em instance} & points to the memory resource used by this instance. \\
\hline
\mbox{\texttt{ out}}  & {\em addr} & points to the variable that will hold the bus address after this function has returned successfully. In case of an error, it won\textquotesingle{}t be changed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily R\+\_\+\+SUCCESS} if the parameter checks pass, {\ttfamily R\+\_\+\+ERROR} otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{_f_b19_subs_8h_ae25bd97c7408f773a168033f016399ba}\label{_f_b19_subs_8h_ae25bd97c7408f773a168033f016399ba}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_getNoiseFaultCount@{FB19Subs\_getNoiseFaultCount}}
\index{FB19Subs\_getNoiseFaultCount@{FB19Subs\_getNoiseFaultCount}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_getNoiseFaultCount()}{FB19Subs\_getNoiseFaultCount()}}
{\footnotesize\ttfamily int FB19\+Subs\+\_\+get\+Noise\+Fault\+Count (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$}]{instance,  }\item[{uint32\+\_\+t $\ast$}]{count }\end{DoxyParamCaption})}

Returns the number of noise faults since the start of this Subscriber instance.

Every noise detection error increases the fault count by one. If more than one noise spike occurred during the time of a character, it is stored as one fault (not several).


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em instance} & points to the memory resource used by this instance. \\
\hline
\mbox{\texttt{ out}}  & {\em count} & points to the variable that will hold the number of noise faults since the start of this module. In case of an error, it won\textquotesingle{}t be changed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily R\+\_\+\+SUCCESS} if the parameter checks pass, {\ttfamily R\+\_\+\+ERROR} otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{_f_b19_subs_8h_a566d446f8e91d34a08aae7d356909a59}\label{_f_b19_subs_8h_a566d446f8e91d34a08aae7d356909a59}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_getRxFaultCount@{FB19Subs\_getRxFaultCount}}
\index{FB19Subs\_getRxFaultCount@{FB19Subs\_getRxFaultCount}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_getRxFaultCount()}{FB19Subs\_getRxFaultCount()}}
{\footnotesize\ttfamily int FB19\+Subs\+\_\+get\+Rx\+Fault\+Count (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$}]{instance,  }\item[{uint32\+\_\+t $\ast$}]{count }\end{DoxyParamCaption})}

Returns the number of receive faults since the start of this Subscriber instance.

Every frame reception error increases the fault count by one. If more than one error occurred during the reception of a frame, it is stored as one fault (not several).


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em instance} & points to the memory resource used by this instance. \\
\hline
\mbox{\texttt{ out}}  & {\em count} & points to the variable that will hold the number of receive faults since the start of this module. In case of an error, it won\textquotesingle{}t be changed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily R\+\_\+\+SUCCESS} if the parameter checks pass, {\ttfamily R\+\_\+\+ERROR} otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{_f_b19_subs_8h_a4f4a523efa22c9dbdff49a67b181a478}\label{_f_b19_subs_8h_a4f4a523efa22c9dbdff49a67b181a478}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_getTxFaultCount@{FB19Subs\_getTxFaultCount}}
\index{FB19Subs\_getTxFaultCount@{FB19Subs\_getTxFaultCount}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_getTxFaultCount()}{FB19Subs\_getTxFaultCount()}}
{\footnotesize\ttfamily int FB19\+Subs\+\_\+get\+Tx\+Fault\+Count (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$}]{instance,  }\item[{uint32\+\_\+t $\ast$}]{count }\end{DoxyParamCaption})}

Returns the number of transmit faults since the start of this Subscriber instance.

Every frame transmission error increases the fault count by one. If more than one error occurred during the transmission of a frame, it is stored as one fault (not several).


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em instance} & points to the memory resource used by this instance. \\
\hline
\mbox{\texttt{ out}}  & {\em count} & points to the variable that will hold the number of transmit faults since the start of this module. In case of an error, it won\textquotesingle{}t be changed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily R\+\_\+\+SUCCESS} if the parameter checks pass, {\ttfamily R\+\_\+\+ERROR} otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{_f_b19_subs_8h_a089309456f180d557fb62bfe9f68db81}\label{_f_b19_subs_8h_a089309456f180d557fb62bfe9f68db81}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_getVersion@{FB19Subs\_getVersion}}
\index{FB19Subs\_getVersion@{FB19Subs\_getVersion}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_getVersion()}{FB19Subs\_getVersion()}}
{\footnotesize\ttfamily const char $\ast$ FB19\+Subs\+\_\+get\+Version (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Returns the start address of the version string, which is a null-\/terminated C-\/string.

This function may be called even if the instance hasn\textquotesingle{}t been started.

\begin{DoxyReturn}{Returns}
The version of this library as null-\/terminated C-\/string. 
\end{DoxyReturn}
\mbox{\Hypertarget{_f_b19_subs_8h_a0dee31fc9ba75a44493cd6e8ae7c6e75}\label{_f_b19_subs_8h_a0dee31fc9ba75a44493cd6e8ae7c6e75}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_handler@{FB19Subs\_handler}}
\index{FB19Subs\_handler@{FB19Subs\_handler}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_handler()}{FB19Subs\_handler()}}
{\footnotesize\ttfamily void FB19\+Subs\+\_\+handler (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$}]{instance }\end{DoxyParamCaption})}

Executes the periodic tasks of this library.

It essentially moves unread messages that came in since the previous {\ttfamily \+\_\+handler()} call aside, fetches the received messages from the driver layer and copies them to the next higher layer, and finally copies the messages to be transmitted to the driver layer.

Set the period between the calls equal to the period on the FB19 Controller. Since the {\ttfamily \+\_\+handler()} calls on the FB19 Controller and its subscribers can\textquotesingle{}t be synchronized, some will call their {\ttfamily \+\_\+handler()} function a bit more frequent than others.~\newline
 If the FB19 Controller\textquotesingle{}s {\ttfamily \+\_\+handler()} function is called more frequent than that of one of its subscribers, every now and then a response message will be returned unchanged, which indicates this scenario.~\newline
 If the FB19 Controller\textquotesingle{}s {\ttfamily \+\_\+handler()} function is called less frequent than that of one of its subscribers, a subscriber will every now and then return {\ttfamily R\+\_\+\+ERROR} when its {\ttfamily \+\_\+submit()} function is called. This indicates that the transmit queue was already full before the call and indicates this scenario.

When it is known for sure that a FB19 Subscriber receives messages from its FB19 Controller only every Nth Controller\textquotesingle{}s {\ttfamily \+\_\+handler()} cycle, the period of the Subscriber\textquotesingle{}s {\ttfamily \+\_\+handler()} calls can be N times of that of the Controller\textquotesingle{}s period.

Moving unread messages to a different buffer prevents \textquotesingle{}message loss\textquotesingle{} when frequent message writer and reader objects (classes, modules, tasks) compete with infrequent writer and reader objects on the available space in the receive message queue. The frequent writers/readers would overwrite (delete) messages of the infrequent writers/readers, since the latter may pick up their response messages just every 2nd, 3rd or xth {\ttfamily \+\_\+handler()} call.

It does nothing if {\ttfamily instance} is a NULL pointer or if the library hasn\textquotesingle{}t been started yet.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em instance} & points to the memory resource used by this instance. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{_f_b19_subs_8h_abaa3b5c370fc792104e2c14e23e4b7d3}\label{_f_b19_subs_8h_abaa3b5c370fc792104e2c14e23e4b7d3}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_start@{FB19Subs\_start}}
\index{FB19Subs\_start@{FB19Subs\_start}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_start()}{FB19Subs\_start()}}
{\footnotesize\ttfamily int FB19\+Subs\+\_\+start (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$}]{instance,  }\item[{const \mbox{\hyperlink{_f_b19_subs_8h_ab3c37fbacd25aba8f93e03f94ddcaa82}{FB19\+Subs\+\_\+cfg\+\_\+t}} $\ast$}]{config,  }\item[{int}]{bit\+Rate }\end{DoxyParamCaption})}

Starts an FB19 Subscriber instance.

The parameter {\ttfamily instance} can be thought of as a \textquotesingle{}handle\textquotesingle{} to the Subscriber instance. It is the start address of the memory area, where the instance stores its internal values (buffers, counters, pointers, ...).

The parameter {\ttfamily config} contains system on chip configuration parameters as well as transmit and receive message buffers. It is left to the user to define how large the buffers shall be. Systems with high message rate peaks and low CPU power require larger buffers than those with steady data exchange.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em instance} & points to the memory resource used by this instance. \\
\hline
\mbox{\texttt{ in}}  & {\em config} & points to the structure that configures this instance. It contains system on chip configuration parameters as well as pointers to the transmit and receive message buffers. It is left to the user to define how large the buffers shall be. For example, systems with high message rate peaks and low CPU power require larger buffers than those with steady data exchange. \\
\hline
\mbox{\texttt{ in}}  & {\em bit\+Rate} & is the number of bits per second during character reception and transmission. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily R\+\_\+\+SUCCESS} if the parameter checks pass, the module instance hasn\textquotesingle{}t been started already and could be started with the passed configuration, {\ttfamily R\+\_\+\+ERROR} otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{_f_b19_subs_8h_a4b17eda87916e2e22a60004aaa377e9d}\label{_f_b19_subs_8h_a4b17eda87916e2e22a60004aaa377e9d}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_stop@{FB19Subs\_stop}}
\index{FB19Subs\_stop@{FB19Subs\_stop}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_stop()}{FB19Subs\_stop()}}
{\footnotesize\ttfamily int FB19\+Subs\+\_\+stop (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$}]{instance }\end{DoxyParamCaption})}

Stops an FB19 Subscriber instance.

Stopping an instance twice without starting it in between returns no error.

Note that a call to this function will neither stop the clock to the configured GPIO nor CRC SoC modules. These modules could be used by other components of the application.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em instance} & points to the memory resource used by this instance. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily R\+\_\+\+SUCCESS} if the parameter checks pass, {\ttfamily R\+\_\+\+ERROR} otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{_f_b19_subs_8h_aba9f9bdf9b3651a6d4d2233670eda546}\label{_f_b19_subs_8h_aba9f9bdf9b3651a6d4d2233670eda546}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_submit@{FB19Subs\_submit}}
\index{FB19Subs\_submit@{FB19Subs\_submit}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_submit()}{FB19Subs\_submit()}}
{\footnotesize\ttfamily int FB19\+Subs\+\_\+submit (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$}]{instance,  }\item[{const \mbox{\hyperlink{ctrl_2_s_t_m32_cube_i_d_e_2_s_t_m32_f401_2_inc_2_f_b19_msg_8h_afa89bd818747be891ceba5148c1b5304}{FB19\+Msg\+\_\+t}} $\ast$}]{msg }\end{DoxyParamCaption})}

Deep copies the message {\ttfamily msg} points to into the transmit message queue of this library. After the next call to the {\ttfamily \+\_\+handler()} function, it is ready for transmission.

It will however only be sent when the FB19 Controller sends this node a request message that matches the message identifier {\ttfamily msg\+Id} inside its descriptor {\ttfamily dscr}.

The messages are transmitted in the order they have been added through the {\ttfamily \+\_\+submit()} calls.

When the transmit message buffer is full before this function is called, it returns {\ttfamily R\+\_\+\+ERROR}. It also returns this value if the descriptor {\ttfamily desc} of the message {\ttfamily msg} points to contains implausible data. Its fields {\ttfamily dst\+Addr}, {\ttfamily msg\+Id} and {\ttfamily pld\+Size} are checked for their range when this function is called.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em instance} & points to the memory resource used by this instance. \\
\hline
\mbox{\texttt{ in}}  & {\em msg} & points to the message that will be added to the transmit queue if this function returns successfully. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily R\+\_\+\+SUCCESS} if the parameter checks pass, the message {\ttfamily msg} points to contains plausible data in the descriptor, and the transmit queue had the capacity to store this message, {\ttfamily R\+\_\+\+ERROR} otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{_f_b19_subs_8h_a5095e2d29f0408048592057b553e7932}\label{_f_b19_subs_8h_a5095e2d29f0408048592057b553e7932}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_timerIRQHandler@{FB19Subs\_timerIRQHandler}}
\index{FB19Subs\_timerIRQHandler@{FB19Subs\_timerIRQHandler}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_timerIRQHandler()}{FB19Subs\_timerIRQHandler()}}
{\footnotesize\ttfamily void FB19\+Subs\+\_\+timer\+IRQHandler (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$}]{instance }\end{DoxyParamCaption})}

Handles the timer interrupts of the associated Timer SoC resource.

Insert it into the TIM2\+\_\+\+IRQHandler() function in the stm32fxxx\+\_\+it.\+c file.

Example\+:~\newline
 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} TIM2\_IRQHandler(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\{}
\DoxyCodeLine{    \mbox{\hyperlink{_f_b19_subs_8h_a5095e2d29f0408048592057b553e7932}{FB19Subs\_timerIRQHandler}}((\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19Subs\_inst\_t}}*)\mbox{\hyperlink{_f_b19_subs_cfg_8h_af64d873f2793e41ad07f18d40a3bf326}{instFB19Subs}});}
\DoxyCodeLine{\}}

\end{DoxyCode}



\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em instance} & points to the memory resource used by this instance. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{_f_b19_subs_8h_ac39b2fe42c5319bab1efe8e0478cc77d}\label{_f_b19_subs_8h_ac39b2fe42c5319bab1efe8e0478cc77d}} 
\index{FB19Subs.h@{FB19Subs.h}!FB19Subs\_UartIRQHandler@{FB19Subs\_UartIRQHandler}}
\index{FB19Subs\_UartIRQHandler@{FB19Subs\_UartIRQHandler}!FB19Subs.h@{FB19Subs.h}}
\doxysubsubsection{\texorpdfstring{FB19Subs\_UartIRQHandler()}{FB19Subs\_UartIRQHandler()}}
{\footnotesize\ttfamily void FB19\+Subs\+\_\+\+Uart\+IRQHandler (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19\+Subs\+\_\+inst\+\_\+t}} $\ast$}]{instance }\end{DoxyParamCaption})}

Handles the USART interrupts of the associated USART SoC resource.

Insert it into the USART2\+\_\+\+IRQHandler() function in the stm32fxxx\+\_\+it.\+c file.

Example\+:~\newline
 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} USART2\_IRQHandler(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\{}
\DoxyCodeLine{    \mbox{\hyperlink{_f_b19_subs_8h_ac39b2fe42c5319bab1efe8e0478cc77d}{FB19Subs\_UartIRQHandler}}((\mbox{\hyperlink{_f_b19_subs_8h_a0eb072feba88985bba0ae1f65baf3cf8}{FB19Subs\_inst\_t}}*)\mbox{\hyperlink{_f_b19_subs_cfg_8h_af64d873f2793e41ad07f18d40a3bf326}{instFB19Subs}});}
\DoxyCodeLine{\}}

\end{DoxyCode}



\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em instance} & points to the memory resource used by this instance. \\
\hline
\end{DoxyParams}
